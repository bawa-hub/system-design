-- Using a MySQL subquery in the WHERE clause

-- returns the customer who has the highest payment.

SELECT 
    customerNumber, 
    checkNumber, 
    amount
FROM
    payments
WHERE
    amount = (SELECT MAX(amount) FROM payments);

--     +----------------+-------------+-----------+
-- | customerNumber | checkNumber | amount    |
-- +----------------+-------------+-----------+
-- |            141 | JE105477    | 120166.58 |
-- +----------------+-------------+-----------+
-- 1 row in set (0.001 sec)


-- find customers whose payments are greater than the average payment using a subquery:

SELECT 
    customerNumber, 
    checkNumber, 
    amount
FROM
    payments
WHERE
    amount > (SELECT 
            AVG(amount)
        FROM
            payments);

--             +----------------+-------------+-----------+
-- | customerNumber | checkNumber | amount    |
-- +----------------+-------------+-----------+
-- |            112 | HQ55022     |  32641.98 |
-- |            112 | ND748579    |  33347.88 |
-- |            114 | GG31455     |  45864.03 |
-- |            114 | MA765515    |  82261.22 |
-- |            114 | NR27552     |  44894.74 |
-- |            119 | LN373447    |  47924.19 |
-- |            119 | NG94694     |  49523.67 |
-- |            121 | DB889831    |  50218.95 |
-- |            121 | MA302151    |  34638.14 |
-- |            124 | AE215433    | 101244.59 |
-- |            124 | BG255406    |  85410.87 |
-- |            124 | ET64396     |  83598.04 |
-- |            124 | HI366474    |  47142.70 |
-- |            124 | HR86578     |  55639.66 |
-- |            124 | KI131716    | 111654.40 |
-- |            124 | LF217299    |  43369.30 |
-- |            124 | NT141748    |  45084.38 |
-- |            128 | FH668230    |  33820.62 |
-- |            131 | MA724562    |  50025.35 |
-- |            131 | NB445135    |  35321.97 |
-- |            141 | AU364101    |  36251.03 |
-- |            141 | DB583216    |  36140.38 |
-- |            141 | DL460618    |  46895.48 |
-- |            141 | HJ32686     |  59830.55 |
-- |            141 | ID10962     | 116208.40 |
-- |            141 | IN446258    |  65071.26 |
-- |            141 | JE105477    | 120166.58 |
-- |            141 | JN355280    |  49539.37 |
-- |            141 | JN722010    |  40206.20 |
-- |            141 | KT52578     |  63843.55 |
-- |            141 | MC46946     |  35420.74 |
-- |            144 | IR846303    |  36005.71 |
-- |            145 | JJ246391    |  53959.21 |
-- |            146 | FP549817    |  40978.53 |
-- |            146 | FU793410    |  49614.72 |
-- |            146 | LJ160635    |  39712.10 |
-- |            148 | BI507030    |  44380.15 |
-- |            148 | KM172879    | 105743.00 |
-- |            151 | BF686658    |  58793.53 |
-- |            151 | IP568906    |  58841.35 |
-- |            151 | KI884577    |  39964.63 |
-- |            157 | HI618861    |  35152.12 |
-- |            157 | NN711988    |  63357.13 |
-- |            161 | BR478494    |  50743.65 |
-- |            161 | NI908214    |  38675.13 |
-- |            166 | BQ327613    |  38785.48 |
-- |            166 | DC979307    |  44160.92 |
-- |            167 | GN228846    |  85024.46 |
-- |            171 | IL104425    |  42783.81 |
-- |            172 | CE51751     |  51209.58 |
-- |            172 | EH208589    |  33383.14 |
-- |            175 | PI15215     |  42044.77 |
-- |            177 | CI381435    |  47177.59 |
-- |            181 | OH367219    |  44400.50 |
-- |            186 | AK412714    |  37602.48 |
-- |            186 | KA602407    |  34341.08 |
-- |            187 | AM968797    |  52825.29 |
-- |            187 | BQ39062     |  47159.11 |
-- |            187 | KL124726    |  48425.69 |
-- |            189 | NM916675    |  32538.74 |
-- |            201 | OO846801    |  37258.94 |
-- |            202 | HI358554    |  36527.61 |
-- |            202 | IQ627690    |  33594.58 |
-- |            204 | GC697638    |  51152.86 |
-- |            205 | LL562733    |  50342.74 |
-- |            205 | NM739638    |  39580.60 |
-- |            209 | BOAF82044   |  35157.75 |
-- |            209 | PH785937    |  36069.26 |
-- |            211 | BJ535230    |  45480.79 |
-- |            216 | MM342086    |  40473.86 |
-- |            227 | MQ413968    |  36164.46 |
-- |            227 | NU21326     |  53745.34 |
-- |            239 | NQ865547    |  80375.24 |
-- |            240 | IF245157    |  46788.14 |
-- |            242 | AF40894     |  33818.34 |
-- |            249 | IJ399820    |  33924.24 |
-- |            249 | NE404084    |  48298.99 |
-- |            256 | HE84936     |  53116.99 |
-- |            259 | EU280955    |  61234.67 |
-- |            260 | IO164641    |  37527.58 |
-- |            276 | KM841847    |  38547.19 |
-- |            276 | LE432182    |  41554.73 |
-- |            278 | BJ483870    |  37654.09 |
-- |            278 | GP636783    |  52151.81 |
-- |            278 | NI983021    |  37723.79 |
-- |            282 | JT819493    |  35806.73 |
-- |            286 | DR578578    |  47411.33 |
-- |            286 | KH910279    |  43134.04 |
-- |            298 | AJ574927    |  47375.92 |
-- |            298 | LF501133    |  61402.00 |
-- |            299 | AD304085    |  36798.88 |
-- |            311 | DG336041    |  46770.52 |
-- |            311 | FA728475    |  32723.04 |
-- |            314 | LQ244073    |  45352.47 |
-- |            319 | HL685576    |  42339.76 |
-- |            319 | OM548174    |  36092.40 |
-- |            320 | HO576374    |  41016.75 |
-- |            320 | MU817160    |  52548.49 |
-- |            321 | DJ15149     |  85559.12 |
-- |            321 | LA556321    |  46781.66 |
-- |            323 | AL493079    |  75020.13 |
-- |            323 | ES347491    |  37281.36 |
-- |            323 | PQ803830    |  39440.59 |
-- |            324 | HB150714    |  37455.77 |
-- |            334 | CS435306    |  45785.34 |
-- |            339 | DA98827     |  34606.28 |
-- |            350 | CI471510    |  50824.66 |
-- |            353 | CO351193    |  49705.52 |
-- |            353 | HJ618252    |  46656.94 |
-- |            357 | NB291497    |  36442.34 |
-- |            363 | HL575273    |  50799.69 |
-- |            363 | PN238558    |  55425.77 |
-- |            379 | FR499138    |  32680.31 |
-- |            382 | CC871084    |  35826.33 |
-- |            382 | PH29054     |  42813.83 |
-- |            385 | EK785462    |  51001.22 |
-- |            386 | DO106109    |  38524.29 |
-- |            386 | HG438769    |  51619.02 |
-- |            398 | AJ478695    |  33967.73 |
-- |            398 | KB54275     |  48927.64 |
-- |            406 | HJ217687    |  49165.16 |
-- |            412 | GH197075    |  35034.57 |
-- |            448 | KR822727    |  48809.90 |
-- |            450 | EF485824    |  59551.38 |
-- |            455 | HA777606    |  38139.18 |
-- |            458 | DD995006    |  33145.56 |
-- |            458 | OO606861    |  57131.92 |
-- |            462 | PE176846    |  48355.87 |
-- |            471 | CO645196    |  35505.63 |
-- |            475 | PB951268    |  36070.47 |
-- |            484 | JH546765    |  47513.19 |
-- |            486 | HS86661     |  45994.07 |
-- |            495 | BH167026    |  59265.14 |
-- |            496 | MN89921     |  52166.00 |
-- +----------------+-------------+-----------+
-- 134 rows in set (0.001 sec)